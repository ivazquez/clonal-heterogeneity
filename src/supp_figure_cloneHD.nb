(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     92629,       2107]
NotebookOptionsPosition[     91434,       2063]
NotebookOutlinePosition[     91791,       2079]
CellTagsIndexPosition[     91748,       2076]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Plot", ",", "LogPlot", ",", "LogLogPlot", ",", "LogLinearPlot", ",", 
       "ListPlot", ",", "ListLogPlot", ",", "ListLogLogPlot", ",", 
       "ListLogLinearPlot", ",", "DensityPlot", ",", "Histogram", ",", 
       "SmoothHistogram", ",", "MatrixPlot", ",", "BarChart"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"14", ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], 
     ",", 
     RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"GridLinesStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Gray", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}]}], "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dir", " ", "=", " ", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<../\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datadir", "=", 
   RowBox[{"dir", "<>", "\"\<data/seq/subclonality/simulations/\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resdir", "=", 
   RowBox[{"dir", "<>", "\"\<data/seq/subclonality/simulations/\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotdir", "=", 
    RowBox[{
    "dir", "<>", "\"\<manuscript/supp/figures/supp_figure_cloneHD\>\""}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opts", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"900", ",", "200"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"30", ",", "30"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"30", ",", "10"}], "}"}]}], "}"}]}], ","}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"None", ",", "None"}], "}"}]}], ","}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.627269335186698*^9, 3.62726933549084*^9}, {
   3.627269389362763*^9, 3.627269402293841*^9}, {3.627269583619258*^9, 
   3.6272695850979357`*^9}, {3.627549844524971*^9, 3.627549858266425*^9}, {
   3.627549909374065*^9, 3.6275499100847473`*^9}, {3.64241892818618*^9, 
   3.642418961660755*^9}, {3.642419002864829*^9, 3.6424190081760683`*^9}, {
   3.642419079665947*^9, 3.6424191635015507`*^9}, {3.6424201474077587`*^9, 
   3.642420147487082*^9}, {3.642420657355304*^9, 3.642420657440884*^9}, {
   3.6424209603692503`*^9, 3.642420983621972*^9}, {3.64242104858444*^9, 
   3.642421063977209*^9}, {3.642421177511485*^9, 3.6424212010458317`*^9}, {
   3.6424224112343283`*^9, 3.6424224740587473`*^9}, {3.6424233048727703`*^9, 
   3.642423327608976*^9}, {3.6424260546476*^9, 3.642426080163804*^9}, 
   3.642426124281372*^9, {3.642426164153859*^9, 3.64242617343826*^9}, {
   3.642426310122156*^9, 3.64242632287506*^9}, {3.642426438469668*^9, 
   3.64242647557629*^9}, 3.642586144736191*^9, {3.644410692295417*^9, 
   3.64441069878808*^9}, {3.644485808430458*^9, 3.6444858086693497`*^9}, {
   3.6445955999092617`*^9, 3.644595600159301*^9}, {3.662147139603097*^9, 
   3.662147202147992*^9}, {3.6621527042301188`*^9, 3.6621527524403477`*^9}, 
   3.6621529107478228`*^9, {3.6669837816961727`*^9, 3.666983910932639*^9}, {
   3.6687989094411507`*^9, 3.6687989398182707`*^9}, {3.668798987963529*^9, 
   3.668799013692298*^9}}],

Cell[CellGroupData[{

Cell["Get real copy number and genotype profiles", "Subsubsection",
 CellChangeTimes->{{3.585390170610374*^9, 3.585390194746237*^9}, {
   3.585390232697372*^9, 3.5853903316490507`*^9}, {3.585390364842546*^9, 
   3.5853904229020433`*^9}, {3.585390454357519*^9, 3.5853905311149197`*^9}, {
   3.5853905730555897`*^9, 3.585390573150868*^9}, {3.5853906084172783`*^9, 
   3.5853906553687677`*^9}, {3.585390746520774*^9, 3.585390757814795*^9}, {
   3.585390865527586*^9, 3.585390878525363*^9}, {3.585390931501997*^9, 
   3.585390932257944*^9}, {3.585391004191474*^9, 3.585391238637249*^9}, {
   3.585393249731121*^9, 3.5853934939021673`*^9}, 3.5853935262084713`*^9, {
   3.585393568692449*^9, 3.585393582944108*^9}, {3.5853936160447617`*^9, 
   3.585393640183182*^9}, {3.585393692196759*^9, 3.585393725445137*^9}, {
   3.585393758803547*^9, 3.585393895444309*^9}, {3.585393930726378*^9, 
   3.585393974019535*^9}, {3.585394004275691*^9, 3.585394126690035*^9}, {
   3.585394159965229*^9, 3.5853941633212547`*^9}, 3.585394229485754*^9, {
   3.58539436821653*^9, 3.5853943933862963`*^9}, {3.585394425814514*^9, 
   3.585394440941558*^9}, {3.5853946744180737`*^9, 3.5853947878795424`*^9}, {
   3.585394817906249*^9, 3.5853948316346483`*^9}, {3.5854027951466513`*^9, 
   3.5854028161166077`*^9}, {3.585402854141841*^9, 3.5854028542229023`*^9}, {
   3.585403382736848*^9, 3.585403434900547*^9}, {3.585403505261424*^9, 
   3.585403547400116*^9}, {3.5854035944229393`*^9, 3.5854036281661663`*^9}, {
   3.58540412072731*^9, 3.585404155235363*^9}, {3.585892368365356*^9, 
   3.585892375708416*^9}, {3.585892537742929*^9, 3.58589256653736*^9}, {
   3.5858931409064074`*^9, 3.585893150801461*^9}, {3.5859028653301888`*^9, 
   3.585902865542757*^9}, {3.5859757052992077`*^9, 3.5859757733997498`*^9}, {
   3.585977137756318*^9, 3.585977154245879*^9}, {3.5859772191970167`*^9, 
   3.5859772600199633`*^9}, {3.5859778573521643`*^9, 3.585977865976012*^9}, {
   3.585978521782778*^9, 3.585978531643568*^9}, 3.5859785643657293`*^9, {
   3.586258541272818*^9, 3.5862585413477163`*^9}, {3.586259848470313*^9, 
   3.5862599270043907`*^9}, {3.586260499671599*^9, 3.586260511908537*^9}, 
   3.586261136574032*^9, {3.586261298796609*^9, 3.5862613177166862`*^9}, {
   3.586261462553914*^9, 3.586261500056015*^9}, {3.586266180369854*^9, 
   3.586266271536047*^9}, {3.5862663272598658`*^9, 3.5862665477404833`*^9}, {
   3.586267372322689*^9, 3.586267473388179*^9}, 3.586267526825321*^9, {
   3.586267575230301*^9, 3.586267589558182*^9}, {3.586267647241536*^9, 
   3.586267720126914*^9}, 3.586267772656439*^9, 3.586267803808257*^9, {
   3.586267872899057*^9, 3.586267923911192*^9}, {3.586267974238491*^9, 
   3.586268282030636*^9}, 3.586268326109323*^9, 3.586268404300692*^9, {
   3.586458536464966*^9, 3.586458557055336*^9}, {3.5864585968856287`*^9, 
   3.586458640092111*^9}, {3.5864591390446*^9, 3.586459149022744*^9}, {
   3.58645922881609*^9, 3.586459252323892*^9}, {3.586459748491438*^9, 
   3.586459767948881*^9}, {3.586459889037423*^9, 3.586459904302607*^9}, 
   3.5864600261058893`*^9, {3.586460147405048*^9, 3.5864601549145327`*^9}, {
   3.586460278683811*^9, 3.586460279013987*^9}, {3.5864603165393*^9, 
   3.586460318961111*^9}, {3.5864604447528343`*^9, 3.586460675306366*^9}, {
   3.58646073603841*^9, 3.586460739305084*^9}, {3.586461101468873*^9, 
   3.5864611015438557`*^9}, {3.586461142121745*^9, 3.586461145601324*^9}, 
   3.586461971892352*^9, 3.586462468691515*^9, {3.586498639998727*^9, 
   3.586498640329228*^9}, {3.586502025478456*^9, 3.586502034342236*^9}, {
   3.586505199963132*^9, 3.5865052003508463`*^9}, {3.5865080330036707`*^9, 
   3.586508033878621*^9}, {3.586509825200979*^9, 3.5865098254466133`*^9}, {
   3.586510553202013*^9, 3.586510561840342*^9}, 3.586511859146224*^9, {
   3.586513556413857*^9, 3.5865135617732677`*^9}, 3.586516246665094*^9, {
   3.586516654022319*^9, 3.5865166646163387`*^9}, {3.586519491797759*^9, 
   3.5865194920981493`*^9}, {3.5865212546931343`*^9, 3.586521269361685*^9}, {
   3.586521850753252*^9, 3.586521856263742*^9}, {3.586522241936098*^9, 
   3.586522242026523*^9}, {3.586529585220025*^9, 3.5865295885813227`*^9}, {
   3.586529875646858*^9, 3.5865298762602863`*^9}, {3.586530262541708*^9, 
   3.5865302732316723`*^9}, {3.586530328859679*^9, 3.586530356848946*^9}, 
   3.5865350697561893`*^9, 3.5865362334429617`*^9, {3.586537163676261*^9, 
   3.586537164464945*^9}, 3.5865386604147043`*^9, 3.586546643276904*^9, {
   3.5865466868574047`*^9, 3.586546694305243*^9}, {3.586546739841673*^9, 
   3.586546771704949*^9}, 3.586577276911972*^9, {3.586602309667749*^9, 
   3.5866023139400883`*^9}, {3.58660745842871*^9, 3.586607474427013*^9}, {
   3.586607974719919*^9, 3.5866079804444036`*^9}, {3.586631907038023*^9, 
   3.586631911946645*^9}, {3.586632710287861*^9, 3.5866327205906076`*^9}, {
   3.589199469985824*^9, 3.589199504498961*^9}, {3.589265240439198*^9, 
   3.589265243786976*^9}, {3.5895278968737783`*^9, 3.589527917193245*^9}, {
   3.589528648654951*^9, 3.589528648741761*^9}, {3.589528859116087*^9, 
   3.589528867930356*^9}, {3.590401419426173*^9, 3.590401549600173*^9}, {
   3.590402212779166*^9, 3.590402222812434*^9}, {3.590402258963916*^9, 
   3.590402264950109*^9}, {3.590402335290023*^9, 3.590402348590548*^9}, {
   3.5904024068828773`*^9, 3.590402497792564*^9}, {3.590402550022368*^9, 
   3.5904025784741697`*^9}, {3.590402683533637*^9, 3.590402713843897*^9}, {
   3.5904027473589487`*^9, 3.590402819708356*^9}, {3.590402852010352*^9, 
   3.5904030832477713`*^9}, 3.590403127391029*^9, 3.59040316856531*^9, {
   3.5904032118021727`*^9, 3.5904033296358213`*^9}, 3.590403407464019*^9, {
   3.590403437877303*^9, 3.590403475346664*^9}, {3.590403512497967*^9, 
   3.59040351258186*^9}, {3.590403551264018*^9, 3.59040355136451*^9}, {
   3.5904035945220737`*^9, 3.590403744427616*^9}, 3.590403792317629*^9, {
   3.590403824651195*^9, 3.590403853863707*^9}, {3.590403885718543*^9, 
   3.590403897497078*^9}, {3.590404052148703*^9, 3.590404333576977*^9}, {
   3.5904044117525473`*^9, 3.5904044582209806`*^9}, {3.590404496041134*^9, 
   3.590404631337801*^9}, 3.5904046822827682`*^9, {3.590404754145595*^9, 
   3.590404757825255*^9}, {3.590404807977405*^9, 3.5904048422651157`*^9}, {
   3.590404884348423*^9, 3.5904049192858152`*^9}, 3.59040509249186*^9, {
   3.590405709864339*^9, 3.5904057510884113`*^9}, {3.59040581231857*^9, 
   3.59040581528017*^9}, {3.590406325413887*^9, 3.590406325563506*^9}, {
   3.5904063713266287`*^9, 3.590406483014785*^9}, {3.590406520012972*^9, 
   3.590406537395718*^9}, 3.590406582503715*^9, {3.590406621389945*^9, 
   3.590406621575609*^9}, {3.590406673258559*^9, 3.590406684107306*^9}, {
   3.5904068132541323`*^9, 3.5904068989624662`*^9}, {3.590406941871361*^9, 
   3.590407002992337*^9}, {3.590407252108757*^9, 3.590407262382489*^9}, {
   3.590407311363647*^9, 3.590407314933853*^9}, {3.5905140748989687`*^9, 
   3.590514089267983*^9}, {3.5905141526456327`*^9, 3.590514179970593*^9}, 
   3.5905172751334143`*^9, {3.5905176195673037`*^9, 3.59051762000285*^9}, {
   3.590518849797724*^9, 3.590518851543606*^9}, {3.590577455124902*^9, 
   3.590577486339415*^9}, {3.590687239434214*^9, 3.5906872458797903`*^9}, {
   3.590689786391954*^9, 3.590689816610256*^9}, {3.5906900317485313`*^9, 
   3.590690051275188*^9}, {3.5906907460678596`*^9, 3.5906907596977053`*^9}, {
   3.5906914112977552`*^9, 3.590691413989876*^9}, {3.5906916220640287`*^9, 
   3.5906916235066566`*^9}, {3.590724487240574*^9, 3.5907244972406063`*^9}, {
   3.5907266224628077`*^9, 3.5907266413837423`*^9}, {3.590756893957244*^9, 
   3.5907569046446037`*^9}, 3.5907577323842707`*^9, {3.590759058402441*^9, 
   3.590759058563734*^9}, {3.590847916641519*^9, 3.590847924977312*^9}, {
   3.5908600629359827`*^9, 3.590860063015726*^9}, 3.590860326607847*^9, {
   3.590903540219911*^9, 3.590903546059182*^9}, 3.590904967914303*^9, {
   3.5910093800195303`*^9, 3.5910093915007067`*^9}, {3.59101179380289*^9, 
   3.5910118338245697`*^9}, {3.59119500360664*^9, 3.591195131482225*^9}, {
   3.59119655693505*^9, 3.5911965611946087`*^9}, {3.591415876599184*^9, 
   3.591415880671273*^9}, {3.591446101097539*^9, 3.5914461068963413`*^9}, {
   3.59170496776637*^9, 3.591705002470359*^9}, {3.592026040331048*^9, 
   3.592026045097117*^9}, {3.5920261792088346`*^9, 3.592026183509735*^9}, 
   3.592026226482728*^9, {3.5920285963266697`*^9, 3.5920285989518433`*^9}, 
   3.5920306548589153`*^9, {3.592054965840523*^9, 3.592054970029377*^9}, {
   3.592056260766364*^9, 3.592056260948555*^9}, {3.592058606175322*^9, 
   3.592058607500535*^9}, {3.592059907563455*^9, 3.592059911124349*^9}, {
   3.592061082123864*^9, 3.592061082207602*^9}, {3.5920715427664824`*^9, 
   3.5920715428376617`*^9}, 3.592073427840623*^9, {3.5920749039860086`*^9, 
   3.5920749040584497`*^9}, {3.592076382904978*^9, 3.592076382950708*^9}, {
   3.5920769651839657`*^9, 3.592076979214267*^9}, {3.592113354020746*^9, 
   3.592113370094575*^9}, {3.592222750717433*^9, 3.592222755729515*^9}, 
   3.592295536344347*^9, 3.592295642968484*^9, 3.592295811681149*^9, 
   3.592296149978237*^9, 3.592296261556779*^9, 3.59229663479242*^9, 
   3.592297326628235*^9, 3.59229744112265*^9, {3.592297781651849*^9, 
   3.59229791058654*^9}, {3.592297995670865*^9, 3.592297995927436*^9}, 
   3.5922982667956553`*^9, 3.592371270752914*^9, {3.592371783660801*^9, 
   3.592371787406706*^9}, {3.5923719997782917`*^9, 3.592372003028379*^9}, {
   3.592372307745817*^9, 3.5923723113524723`*^9}, {3.592374592723054*^9, 
   3.592374616223283*^9}, {3.592374659920478*^9, 3.5923747219675903`*^9}, {
   3.5923750255276833`*^9, 3.592375025937999*^9}, {3.592375140474114*^9, 
   3.592375156038001*^9}, {3.5923752003773613`*^9, 3.592375583156663*^9}, {
   3.592377269045718*^9, 3.592377278692971*^9}, {3.5923773293634043`*^9, 
   3.592377352536663*^9}, {3.59237740265958*^9, 3.592377406444112*^9}, {
   3.5924763951345654`*^9, 3.592476435123066*^9}, {3.592509434616349*^9, 
   3.592509447744224*^9}, {3.59259441000799*^9, 3.592594532361755*^9}, {
   3.594986200821941*^9, 3.594986210387912*^9}, {3.6445924263019743`*^9, 
   3.644592428697988*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"clones", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"datadir", "<>", "\"\<clones.txt\>\""}], ",", "\"\<Table\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mass", "=", 
   RowBox[{"clones", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Mass", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]", "=", 
   RowBox[{"clones", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"nS", ",", "nC"}], "}"}], "=", 
  RowBox[{"Dimensions", "[", "\[Alpha]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]", "//", "MatrixForm"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"color", " ", "settings"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gtColor", "[", "x_", "]"}], ":=", 
   RowBox[{"Blend", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}], "[", "1", 
        "]"}], ",", 
       RowBox[{
        RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}], "[", "0", 
        "]"}]}], "}"}], ",", "x"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gtColors", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"gtColor", "[", "#", "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0.5", ",", "0"}], "}"}]}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"NA", "/", "NA"}], ",", " ", 
     RowBox[{"WA", "/", "NA"}], ",", " ", 
     RowBox[{"WA", "/", "WA"}]}], "*)"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hexToRGB", "=", 
   RowBox[{
    RowBox[{"RGBColor", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"IntegerDigits", "[", 
        RowBox[{
         RowBox[{
         "#", "~", "StringDrop", "~", "1", "~", "FromDigits", "~", "16"}], 
         ",", "256", ",", "3"}], "]"}], "/", "255."}], ")"}]}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bulkColor", "=", 
   RowBox[{"hexToRGB", "[", "\"\<#8b8b8b\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cloneColors", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"hexToRGB", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<#30a2da\>\"", ",", "\"\<#fc4f30\>\"", ",", "\"\<#e5ae38\>\"", 
         ",", "\"\<#6d904f\>\"", ",", "\"\<#8b8b8b\>\"", ",", 
         "\"\<#32a273\>\""}], "}"}]}], ")"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "nC"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", "#", "]"}], ",", 
       RowBox[{"Rectangle", "[", "]"}]}], "}"}], "]"}], "&"}], "/@", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "bulkColor", "}"}], ",", "cloneColors"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.585390170610374*^9, 3.585390194746237*^9}, {
   3.585390232697372*^9, 3.5853903316490507`*^9}, {3.585390364842546*^9, 
   3.5853904229020433`*^9}, {3.585390454357519*^9, 3.5853905311149197`*^9}, {
   3.5853905730555897`*^9, 3.585390573150868*^9}, {3.5853906084172783`*^9, 
   3.5853906553687677`*^9}, {3.585390746520774*^9, 3.585390757814795*^9}, {
   3.585390865527586*^9, 3.585390878525363*^9}, {3.585390931501997*^9, 
   3.585390932257944*^9}, {3.585391004191474*^9, 3.585391238637249*^9}, {
   3.585393249731121*^9, 3.5853934939021673`*^9}, 3.5853935262084713`*^9, {
   3.585393568692449*^9, 3.585393582944108*^9}, {3.5853936160447617`*^9, 
   3.585393640183182*^9}, {3.585393692196759*^9, 3.585393725445137*^9}, {
   3.585393758803547*^9, 3.585393895444309*^9}, {3.585393930726378*^9, 
   3.585393974019535*^9}, {3.585394004275691*^9, 3.585394126690035*^9}, {
   3.585394159965229*^9, 3.5853941633212547`*^9}, 3.585394229485754*^9, {
   3.58539436821653*^9, 3.5853943933862963`*^9}, {3.585394425814514*^9, 
   3.585394440941558*^9}, {3.5853946744180737`*^9, 3.5853947878795424`*^9}, {
   3.585394817906249*^9, 3.5853948316346483`*^9}, {3.5854027951466513`*^9, 
   3.5854028161166077`*^9}, {3.585402854141841*^9, 3.5854028542229023`*^9}, {
   3.585403382736848*^9, 3.585403434900547*^9}, {3.585403505261424*^9, 
   3.585403547400116*^9}, {3.5854035944229393`*^9, 3.5854036281661663`*^9}, {
   3.58540412072731*^9, 3.585404155235363*^9}, {3.585892368365356*^9, 
   3.585892375708416*^9}, {3.585892537742929*^9, 3.58589256653736*^9}, {
   3.5858931409064074`*^9, 3.585893150801461*^9}, {3.5859028653301888`*^9, 
   3.585902865542757*^9}, {3.5859757052992077`*^9, 3.5859757733997498`*^9}, {
   3.585977137756318*^9, 3.585977154245879*^9}, {3.5859772191970167`*^9, 
   3.5859772600199633`*^9}, {3.5859778573521643`*^9, 3.585977865976012*^9}, {
   3.585978521782778*^9, 3.585978531643568*^9}, 3.5859785643657293`*^9, {
   3.586258541272818*^9, 3.5862585413477163`*^9}, {3.586259848470313*^9, 
   3.5862599270043907`*^9}, {3.586260499671599*^9, 3.586260511908537*^9}, 
   3.586261136574032*^9, {3.586261298796609*^9, 3.5862613177166862`*^9}, {
   3.586261462553914*^9, 3.586261500056015*^9}, {3.586266180369854*^9, 
   3.586266271536047*^9}, {3.5862663272598658`*^9, 3.5862665477404833`*^9}, {
   3.586267372322689*^9, 3.586267473388179*^9}, 3.586267526825321*^9, {
   3.586267575230301*^9, 3.586267589558182*^9}, {3.586267647241536*^9, 
   3.586267720126914*^9}, 3.586267772656439*^9, 3.586267803808257*^9, {
   3.586267872899057*^9, 3.586267923911192*^9}, {3.586267974238491*^9, 
   3.586268282030636*^9}, 3.586268326109323*^9, 3.586268404300692*^9, {
   3.586458536464966*^9, 3.586458557055336*^9}, {3.5864585968856287`*^9, 
   3.586458640092111*^9}, {3.5864591390446*^9, 3.586459149022744*^9}, {
   3.58645922881609*^9, 3.586459252323892*^9}, {3.586459748491438*^9, 
   3.586459767948881*^9}, {3.586459889037423*^9, 3.586459904302607*^9}, 
   3.5864600261058893`*^9, {3.586460147405048*^9, 3.5864601549145327`*^9}, {
   3.586460278683811*^9, 3.586460279013987*^9}, {3.5864603165393*^9, 
   3.586460318961111*^9}, {3.5864604447528343`*^9, 3.586460675306366*^9}, {
   3.58646073603841*^9, 3.586460739305084*^9}, {3.586461101468873*^9, 
   3.5864611015438557`*^9}, {3.586461142121745*^9, 3.586461145601324*^9}, 
   3.586461971892352*^9, 3.586462468691515*^9, {3.586498639998727*^9, 
   3.586498640329228*^9}, {3.586502025478456*^9, 3.586502034342236*^9}, {
   3.586505199963132*^9, 3.5865052003508463`*^9}, {3.5865080330036707`*^9, 
   3.586508033878621*^9}, {3.586509825200979*^9, 3.5865098254466133`*^9}, {
   3.586510553202013*^9, 3.586510561840342*^9}, 3.586511859146224*^9, {
   3.586513556413857*^9, 3.5865135617732677`*^9}, 3.586516246665094*^9, {
   3.586516654022319*^9, 3.5865166646163387`*^9}, {3.586519491797759*^9, 
   3.5865194920981493`*^9}, {3.5865212546931343`*^9, 3.586521269361685*^9}, {
   3.586521850753252*^9, 3.586521856263742*^9}, {3.586522241936098*^9, 
   3.586522242026523*^9}, {3.586529585220025*^9, 3.5865295885813227`*^9}, {
   3.586529875646858*^9, 3.5865298762602863`*^9}, {3.586530262541708*^9, 
   3.5865302732316723`*^9}, {3.586530328859679*^9, 3.586530356848946*^9}, 
   3.5865350697561893`*^9, 3.5865362334429617`*^9, {3.586537163676261*^9, 
   3.586537164464945*^9}, 3.5865386604147043`*^9, 3.586546643276904*^9, {
   3.5865466868574047`*^9, 3.586546694305243*^9}, {3.586546739841673*^9, 
   3.586546771704949*^9}, 3.586577276911972*^9, {3.586602309667749*^9, 
   3.5866023139400883`*^9}, {3.58660745842871*^9, 3.586607474427013*^9}, {
   3.586607974719919*^9, 3.5866079804444036`*^9}, {3.586631907038023*^9, 
   3.586631911946645*^9}, {3.586632710287861*^9, 3.5866327205906076`*^9}, {
   3.589199469985824*^9, 3.589199504498961*^9}, {3.589265240439198*^9, 
   3.589265243786976*^9}, {3.5895278968737783`*^9, 3.589527917193245*^9}, {
   3.589528648654951*^9, 3.589528648741761*^9}, {3.589528859116087*^9, 
   3.589528867930356*^9}, {3.590401419426173*^9, 3.590401549600173*^9}, {
   3.590402212779166*^9, 3.590402222812434*^9}, {3.590402258963916*^9, 
   3.590402264950109*^9}, {3.590402335290023*^9, 3.590402348590548*^9}, {
   3.5904024068828773`*^9, 3.590402497792564*^9}, {3.590402550022368*^9, 
   3.5904025784741697`*^9}, {3.590402683533637*^9, 3.590402713843897*^9}, {
   3.5904027473589487`*^9, 3.590402819708356*^9}, {3.590402852010352*^9, 
   3.5904030832477713`*^9}, 3.590403127391029*^9, 3.59040316856531*^9, {
   3.5904032118021727`*^9, 3.5904033296358213`*^9}, 3.590403407464019*^9, {
   3.590403437877303*^9, 3.590403475346664*^9}, {3.590403512497967*^9, 
   3.59040351258186*^9}, {3.590403551264018*^9, 3.59040355136451*^9}, {
   3.5904035945220737`*^9, 3.590403744427616*^9}, 3.590403792317629*^9, {
   3.590403824651195*^9, 3.590403853863707*^9}, {3.590403885718543*^9, 
   3.590403897497078*^9}, {3.590404052148703*^9, 3.590404333576977*^9}, {
   3.5904044117525473`*^9, 3.5904044582209806`*^9}, {3.590404496041134*^9, 
   3.590404631337801*^9}, 3.5904046822827682`*^9, {3.590404754145595*^9, 
   3.590404757825255*^9}, {3.590404807977405*^9, 3.5904048422651157`*^9}, {
   3.590404884348423*^9, 3.5904049192858152`*^9}, 3.59040509249186*^9, {
   3.590405709864339*^9, 3.5904057510884113`*^9}, {3.59040581231857*^9, 
   3.59040581528017*^9}, {3.590406325413887*^9, 3.590406325563506*^9}, {
   3.5904063713266287`*^9, 3.590406483014785*^9}, {3.590406520012972*^9, 
   3.590406537395718*^9}, 3.590406582503715*^9, {3.590406621389945*^9, 
   3.590406621575609*^9}, {3.590406673258559*^9, 3.590406684107306*^9}, {
   3.5904068132541323`*^9, 3.5904068989624662`*^9}, {3.590406941871361*^9, 
   3.590407002992337*^9}, {3.590407252108757*^9, 3.590407262382489*^9}, {
   3.590407311363647*^9, 3.590407314933853*^9}, {3.5905140748989687`*^9, 
   3.590514089267983*^9}, {3.5905141526456327`*^9, 3.590514179970593*^9}, 
   3.5905172751334143`*^9, {3.5905176195673037`*^9, 3.59051762000285*^9}, {
   3.590518849797724*^9, 3.590518851543606*^9}, {3.590577455124902*^9, 
   3.590577486339415*^9}, {3.590687239434214*^9, 3.5906872458797903`*^9}, {
   3.590689786391954*^9, 3.590689816610256*^9}, {3.5906900317485313`*^9, 
   3.590690051275188*^9}, {3.5906907460678596`*^9, 3.5906907596977053`*^9}, {
   3.5906914112977552`*^9, 3.590691413989876*^9}, {3.5906916220640287`*^9, 
   3.5906916235066566`*^9}, {3.590724487240574*^9, 3.5907244972406063`*^9}, {
   3.5907266224628077`*^9, 3.5907266413837423`*^9}, {3.590756893957244*^9, 
   3.5907569046446037`*^9}, 3.5907577323842707`*^9, {3.590759058402441*^9, 
   3.590759058563734*^9}, {3.590847916641519*^9, 3.590847924977312*^9}, {
   3.5908600629359827`*^9, 3.590860063015726*^9}, 3.590860326607847*^9, {
   3.590903540219911*^9, 3.590903546059182*^9}, 3.590904967914303*^9, {
   3.5910093800195303`*^9, 3.5910093915007067`*^9}, {3.59101179380289*^9, 
   3.5910118338245697`*^9}, {3.59119500360664*^9, 3.591195131482225*^9}, {
   3.59119655693505*^9, 3.5911965611946087`*^9}, {3.591415876599184*^9, 
   3.591415880671273*^9}, {3.591446101097539*^9, 3.5914461068963413`*^9}, {
   3.59170496776637*^9, 3.591705002470359*^9}, {3.592026040331048*^9, 
   3.592026045097117*^9}, {3.5920261792088346`*^9, 3.592026183509735*^9}, 
   3.592026226482728*^9, {3.5920285963266697`*^9, 3.5920285989518433`*^9}, 
   3.5920306548589153`*^9, {3.592054965840523*^9, 3.592054970029377*^9}, {
   3.592056260766364*^9, 3.592056260948555*^9}, {3.592058606175322*^9, 
   3.592058607500535*^9}, {3.592059907563455*^9, 3.592059911124349*^9}, {
   3.592061082123864*^9, 3.592061082207602*^9}, {3.5920715427664824`*^9, 
   3.5920715428376617`*^9}, 3.592073427840623*^9, {3.5920749039860086`*^9, 
   3.5920749040584497`*^9}, {3.592076382904978*^9, 3.592076382950708*^9}, {
   3.5920769651839657`*^9, 3.592076979214267*^9}, {3.592113354020746*^9, 
   3.592113370094575*^9}, {3.592222750717433*^9, 3.592222755729515*^9}, 
   3.592295536344347*^9, 3.592295642968484*^9, 3.592295811681149*^9, 
   3.592296149978237*^9, 3.592296261556779*^9, 3.59229663479242*^9, 
   3.592297326628235*^9, 3.59229744112265*^9, {3.592297781651849*^9, 
   3.59229791058654*^9}, {3.592297995670865*^9, 3.592297995927436*^9}, 
   3.5922982667956553`*^9, 3.592371270752914*^9, {3.592371783660801*^9, 
   3.592371787406706*^9}, {3.5923719997782917`*^9, 3.592372003028379*^9}, {
   3.592372307745817*^9, 3.5923723113524723`*^9}, {3.592374592723054*^9, 
   3.592374616223283*^9}, {3.592374659920478*^9, 3.5923747219675903`*^9}, {
   3.5923750255276833`*^9, 3.592375025937999*^9}, {3.592375140474114*^9, 
   3.592375156038001*^9}, {3.5923752003773613`*^9, 3.592375583156663*^9}, {
   3.592377269045718*^9, 3.592377278692971*^9}, {3.5923773293634043`*^9, 
   3.592377352536663*^9}, {3.59237740265958*^9, 3.592377406444112*^9}, {
   3.5924763951345654`*^9, 3.592476435123066*^9}, {3.592509434616349*^9, 
   3.592509447744224*^9}, {3.59259441000799*^9, 3.592594629214748*^9}, {
   3.592595401794654*^9, 3.5925954027925053`*^9}, {3.5927421559476433`*^9, 
   3.592742159148048*^9}, {3.5949862418665457`*^9, 3.594986244200839*^9}, {
   3.594986368434518*^9, 3.594986420723773*^9}, {3.594989744648898*^9, 
   3.594989759758741*^9}, {3.595074060504341*^9, 3.595074060774056*^9}, {
   3.595253847585081*^9, 3.595253877387788*^9}, {3.600442624418255*^9, 
   3.60044276028679*^9}, {3.600442817258131*^9, 3.600442841223186*^9}, 
   3.600448535838873*^9, 3.6007793819555187`*^9, {3.6007795866723013`*^9, 
   3.600779641885648*^9}, {3.6007799001134863`*^9, 3.600779937148567*^9}, {
   3.602238648605382*^9, 3.6022386553828907`*^9}, 3.6022422368698177`*^9, {
   3.602273933730596*^9, 3.602273939721325*^9}, {3.602314827241542*^9, 
   3.6023148279797297`*^9}, {3.6156860544534817`*^9, 3.615686060980267*^9}, {
   3.627269453664916*^9, 3.6272694689533567`*^9}, {3.627269570190094*^9, 
   3.6272696915857*^9}, {3.627269745819475*^9, 3.627269814620905*^9}, {
   3.627322788336444*^9, 3.627322813904027*^9}, {3.62732369688729*^9, 
   3.627323756571763*^9}, {3.627323817508803*^9, 3.6273238783771353`*^9}, {
   3.6273240003292933`*^9, 3.627324001215354*^9}, {3.627324050967207*^9, 
   3.627324295164218*^9}, {3.62732437330767*^9, 3.6273244735896597`*^9}, {
   3.627324503801354*^9, 3.627324508254057*^9}, 3.627324552703622*^9, {
   3.627324603498307*^9, 3.627324644198002*^9}, {3.627324678640047*^9, 
   3.627325038487896*^9}, {3.6273251123138113`*^9, 3.6273251260582333`*^9}, {
   3.627325167170394*^9, 3.627325251827696*^9}, {3.6273256643233633`*^9, 
   3.627325718805008*^9}, {3.627325873762062*^9, 3.6273259537698927`*^9}, {
   3.627326055330003*^9, 3.627326086099736*^9}, {3.62732613734382*^9, 
   3.627326256812086*^9}, {3.6273263504268*^9, 3.627326375519129*^9}, {
   3.627326406900629*^9, 3.627326432328108*^9}, {3.627326491037897*^9, 
   3.627326577282938*^9}, {3.6273271466498127`*^9, 3.627327193654406*^9}, {
   3.6273272271372633`*^9, 3.627327230973135*^9}, {3.627327320800331*^9, 
   3.627327321448545*^9}, {3.627327438623871*^9, 3.627327527544571*^9}, {
   3.627327571314151*^9, 3.6273276035623417`*^9}, {3.627327639411319*^9, 
   3.6273276539710913`*^9}, {3.6273277086072493`*^9, 3.627327725108836*^9}, {
   3.6275396438409157`*^9, 3.6275396602322807`*^9}, 3.627542791369904*^9, {
   3.627543290627303*^9, 3.627543294766324*^9}, {3.6424110596130037`*^9, 
   3.642411079736994*^9}, {3.6424128612826433`*^9, 3.642412938011685*^9}, {
   3.642422481414818*^9, 3.642422481682708*^9}, {3.6424229045118628`*^9, 
   3.6424229071520243`*^9}, 3.6424230450733*^9, {3.642423098782159*^9, 
   3.642423147849375*^9}, {3.642423227331921*^9, 3.6424232485076427`*^9}, {
   3.642423541120462*^9, 3.642423593954356*^9}, {3.642423637491416*^9, 
   3.6424236413061*^9}, {3.6424237049385*^9, 3.642423769118161*^9}, {
   3.642425913358294*^9, 3.64242597889181*^9}, {3.642426144613872*^9, 
   3.642426161645981*^9}, {3.642426253633622*^9, 3.642426289167395*^9}, {
   3.642426327233724*^9, 3.642426356241953*^9}, {3.6444107923689613`*^9, 
   3.6444108135536346`*^9}, {3.6444109790664682`*^9, 3.644410987228423*^9}, {
   3.644411038900766*^9, 3.6444110542413473`*^9}, {3.644411099231647*^9, 
   3.6444111424196053`*^9}, 3.6444777320581827`*^9, {3.644477889330546*^9, 
   3.644477889441931*^9}, {3.644478020533147*^9, 3.644478066647838*^9}, {
   3.644478118596217*^9, 3.644478155248322*^9}, {3.6444782223368*^9, 
   3.64447824247871*^9}, {3.644478325170602*^9, 3.644478333750778*^9}, 
   3.644478416148538*^9, {3.6444785499028683`*^9, 3.644478596186818*^9}, {
   3.644592300157084*^9, 3.6445923074589233`*^9}, {3.644592404848279*^9, 
   3.644592495677273*^9}, {3.644593351342169*^9, 3.6445933542556143`*^9}, {
   3.66215062401062*^9, 3.662150635469264*^9}, {3.662150669689518*^9, 
   3.6621506747418613`*^9}, {3.662150741515975*^9, 3.6621507733054934`*^9}, {
   3.662150804921793*^9, 3.662150809790325*^9}, {3.662150865305044*^9, 
   3.662150882409081*^9}, {3.662150983988888*^9, 3.662150994857018*^9}, {
   3.662151105292962*^9, 3.662151199949106*^9}, 3.662152011129434*^9, 
   3.662152200268236*^9, 3.6621522703476963`*^9, {3.6669691371624537`*^9, 
   3.666969140521112*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Time evolution of clone frequencies", "Subsection",
 CellChangeTimes->{{3.644508768752779*^9, 3.644508778017445*^9}}],

Cell[BoxData[{
 RowBox[{"plot", "=", 
  RowBox[{"BarChart", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"#", ",", 
         RowBox[{"1", "-", 
          RowBox[{"Tr", "[", "#", "]"}]}]}], "}"}], "]"}], "&"}], "/@", 
     "\[Alpha]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.35", ",", "4.0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.05"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ChartLayout", "\[Rule]", "\"\<Stacked\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ChartLabels", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"\"\<t\>\"", "<>", 
            RowBox[{"ToString", "[", "#", "]"}]}], ",", "16"}], "]"}], "&"}], 
        "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "nS"}], "]"}]}], ",", "None"}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"EdgeForm", "[", "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Join", "[", 
        RowBox[{"cloneColors", ",", 
         RowBox[{"{", "bulkColor", "}"}]}], "]"}]}], ")"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"400", ",", "300"}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"30", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"GridLines", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"None", ",", "Automatic"}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"plotdir", "<>", "\"\<clonal.time.evo.pdf\>\""}], ",", "plot"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6444769914928637`*^9, 3.644477087614925*^9}, {
   3.644477139716956*^9, 3.644477156558094*^9}, {3.644477246446638*^9, 
   3.6444773228194523`*^9}, {3.644477361173582*^9, 3.644477427901718*^9}, {
   3.644477481968441*^9, 3.644477784032062*^9}, {3.644477818409976*^9, 
   3.644477833046055*^9}, 3.6444778818713703`*^9, {3.64447826258328*^9, 
   3.64447826500263*^9}, {3.6444858917494698`*^9, 3.644485921301021*^9}, {
   3.6445949483682404`*^9, 3.6445949587188396`*^9}, {3.644595007741127*^9, 
   3.644595026804245*^9}, {3.645290891490155*^9, 3.645290892552384*^9}, 
   3.6669839742376413`*^9}],

Cell[BoxData[{
 RowBox[{"pies", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"PieChart", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"1", "-", 
            RowBox[{"Tr", "[", "#", "]"}]}]}], "}"}], "]"}], "&"}], "/@", 
       RowBox[{"{", "#1", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"ChartStyle", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Opacity", "[", "1", "]"}], ",", 
            RowBox[{"EdgeForm", "[", "]"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Join", "[", 
          RowBox[{"cloneColors", ",", 
           RowBox[{"{", "bulkColor", "}"}]}], "]"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImagePadding", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "200"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"SectorOrigin", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "\"\<Counterclockwise\>\""}], "}"}], ",", ".5"}], 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Background", "\[Rule]", "Transparent"}]}], "]"}], "&"}], "/@", 
   "\[Alpha]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"plotdir", "<>", "\"\<clonal.time.evo.pie_\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.svg\>\""}], ",", 
     RowBox[{"pies", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "pies", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.645291028445443*^9, 3.6452911025484657`*^9}, {
  3.645291141698852*^9, 3.645291157761362*^9}, {3.645291210894099*^9, 
  3.6452914204236917`*^9}, {3.645291529571598*^9, 3.645291550871903*^9}, {
  3.645291979398654*^9, 3.645291983036949*^9}, {3.6452920368418837`*^9, 
  3.64529204075876*^9}, {3.645292120194035*^9, 3.645292125059437*^9}, {
  3.645292217608213*^9, 3.645292259422145*^9}, {3.64529242777497*^9, 
  3.645292432897924*^9}, {3.662153467292192*^9, 3.662153467744341*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot of clonal genotypes (not phased)", "Subsection",
 CellChangeTimes->{{3.627544895287052*^9, 3.6275449007335863`*^9}, {
  3.64241957455239*^9, 3.6424195815412607`*^9}, {3.6444109962781897`*^9, 
  3.644411030899703*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"loci", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"datadir", "<>", "\"\<loci.txt\>\""}], ",", "\"\<Table\>\""}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cna", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"datadir", "<>", "\"\<clonal.true.cna.txt\>\""}], ",", 
      "\"\<Table\>\""}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"snv", "=", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"datadir", "<>", "\"\<clonal.true.snv.txt\>\""}], ",", 
       "\"\<Table\>\""}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"2", ";;", 
        RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"snvjumps", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"datadir", "<>", "\"\<clonal.true.snv.jumps.txt\>\""}], ",", 
      "\"\<Table\>\""}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"cnajumps", "=", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"datadir", "<>", "\"\<clonal.true.cna.jumps.txt\>\""}], ",", 
       "\"\<Table\>\""}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"snvSeg", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"snv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"snv", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "#"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
    "snvjumps"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrependTo", "[", 
   RowBox[{"snvSeg", ",", 
    RowBox[{"snv", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"snvSeg", ",", 
     RowBox[{"snv", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnaSeg", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"cna", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"snv", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "#"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
    "cnajumps"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrependTo", "[", 
   RowBox[{"cnaSeg", ",", 
    RowBox[{"cna", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"cnaSeg", ",", 
     RowBox[{"cna", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"breaks", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "snvSeg", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "1"}], "||", 
          RowBox[{
           RowBox[{
            RowBox[{"Differences", "[", 
             RowBox[{"snvSeg", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"#", "-", "1"}], "]"}], "]"}], "\[NotEqual]", "0"}], "||", 
          RowBox[{"#", "\[Equal]", 
           RowBox[{"Length", "[", "snvSeg", "]"}]}]}], ")"}], "&"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "nC"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"snvSeg", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"snvSeg", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"breaks", "[", 
         RowBox[{"[", "n", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "nC"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"breaks", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "cnaSeg", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "1"}], "||", 
          RowBox[{
           RowBox[{
            RowBox[{"Differences", "[", 
             RowBox[{"cnaSeg", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"#", "-", "1"}], "]"}], "]"}], "\[NotEqual]", "0"}], "||", 
          RowBox[{"#", "\[Equal]", 
           RowBox[{"Length", "[", "cnaSeg", "]"}]}]}], ")"}], "&"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "nC"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnaSeg", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"cnaSeg", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"breaks", "[", 
         RowBox[{"[", "n", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "nC"}], "}"}]}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rects", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"snvSeg", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "l"}], "&"}]}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"cnaSeg", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "l"}], "&"}]}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "nC"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"cnaSeg", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"snvSeg", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "All", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
      "}"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"span", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"0.0", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"loci", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "-", 
       RowBox[{"loci", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ",", 
    RowBox[{"0.0", "*", 
     RowBox[{"Max", "[", 
      RowBox[{"cna", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}]}], "]"}], "]"}], "]"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"range", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"loci", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"span", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"loci", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "+", 
        RowBox[{"span", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"span", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"cna", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}]}], "]"}], "]"}], "]"}], "+", 
        RowBox[{"span", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clonesPlot", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"loci", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"loci", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "range"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", "5", "]"}], ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Evaluate", "[", "opts", "]"}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"j", "\[LessEqual]", 
                RowBox[{"rects", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "i", ",", "2"}], "]"}], "]"}]}], ",", 
               RowBox[{"c", "=", 
                RowBox[{"gtColors", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"c", "=", 
                RowBox[{"gtColors", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Directive", "[", 
              RowBox[{"c", ",", 
               RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rects", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"j", "-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rects", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", 
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], ",", 
                "j"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"rects", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"rects", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "i", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{"Gray", ",", 
              RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
              RowBox[{"Opacity", "[", "1", "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"rects", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"rects", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "i", ",", "2"}], "]"}], "]"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"rects", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", 
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"rects", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "i", ",", "2"}], "]"}], "]"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"rects", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", 
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"rects", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", 
                    RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}]}], 
                "}"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"rects", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
        "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "nC"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"plotdir", "<>", "\"\<clones.\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.pdf\>\""}], ",", 
     RowBox[{"clonesPlot", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "nC"}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.62754279608745*^9, {3.627542831922681*^9, 3.627542924279345*^9}, {
   3.627543153323018*^9, 3.627543157381544*^9}, {3.627543261454585*^9, 
   3.6275432633963842`*^9}, {3.6275433135486917`*^9, 3.627543508145911*^9}, {
   3.6275442193918858`*^9, 3.627544232872239*^9}, {3.627544785552514*^9, 
   3.627544808759285*^9}, {3.627547314464102*^9, 3.627547315127996*^9}, {
   3.6275499283953238`*^9, 3.6275499983394737`*^9}, {3.6275508586936502`*^9, 
   3.627550941335597*^9}, {3.642411147197022*^9, 3.642411149331712*^9}, {
   3.6424111899669237`*^9, 3.642411214405126*^9}, {3.642411247850259*^9, 
   3.642411332464764*^9}, {3.6424114033676767`*^9, 3.642411432426764*^9}, {
   3.642419211816743*^9, 3.642419234308605*^9}, {3.64242032648715*^9, 
   3.642420384625308*^9}, {3.642420455721415*^9, 3.642420530418467*^9}, {
   3.642420582935898*^9, 3.642420612826543*^9}, 3.642580541606415*^9, 
   3.644410966540362*^9, {3.6445924147141113`*^9, 3.6445924163653193`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Allele frequencies of true bulk and clones", "Subsection",
 CellChangeTimes->{{3.6445923619758253`*^9, 3.644592378426676*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"bulk", "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"datadir", "<>", "\"\<true.bulk.txt\>\""}], ",", 
        "\"\<Table\>\""}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"snv", "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"datadir", "<>", "\"\<clonal.true.snv.txt\>\""}], ",", 
        "\"\<Table\>\""}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"2", ";;", 
         RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mixtureSNV", "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"datadir", "<>", "\"\<mixture.snv.txt\>\""}], ",", 
        "\"\<Table\>\""}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"2", ";;", 
         RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bulkSNV", "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"datadir", "<>", "\"\<bulk.snv.txt\>\""}], ",", 
        "\"\<Table\>\""}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"2", ";;", 
         RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bulkInf", "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"resdir", "<>", "\"\<bulk.snv.posterior-1.txt\>\""}], ",", 
        "\"\<Table\>\""}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", ";;", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"clonalInf", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"resdir", "<>", "\"\<mixture.snv.posterior.txt\>\""}], ",", 
       "\"\<Table\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bulk", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "/=", 
     SuperscriptBox["10", "3"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"snv", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "/=", 
     SuperscriptBox["10", "3"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mixtureSNV", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "/=", 
     SuperscriptBox["10", "3"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bulkSNV", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "/=", 
     SuperscriptBox["10", "3"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bulkInf", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "/=", 
     SuperscriptBox["10", "3"]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"levels", "=", 
     RowBox[{"clonalInf", "[", 
      RowBox[{"[", 
       RowBox[{"4", ";;", "6"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"range", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "1", ",", "0.25"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ticks", "[", 
      RowBox[{"min_", ",", "max_"}], "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"val", "=", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"Abs", "@", 
              RowBox[{"FractionalPart", "[", "i", "]"}]}], ",", "0.01"}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Chop", "[", 
             RowBox[{"Min", "[", 
              RowBox[{"Abs", "[", 
               RowBox[{"range", "-", "val"}], "]"}], "]"}], "]"}], "\[Equal]",
             "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{".005", ",", "0"}], "}"}], ",", "Black"}], "}"}], ",", 
           RowBox[{"1", "<", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "\"\<\>\"", ",", 
             RowBox[{"{", 
              RowBox[{".0025", ",", "0"}], "}"}], ",", "Black"}], "}"}]}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Floor", "[", "min", "]"}], ",", 
         RowBox[{"Ceiling", "[", "max", "]"}], ",", "0.05"}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"plot", "=", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "bulk", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"snv", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"snv", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"s", "+", "1"}]}], "]"}], "]"}], "/", "2"}]}], "}"}],
            "\[Transpose]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", "nC"}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"#", ",", 
            RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
            RowBox[{"Opacity", "[", "0.9", "]"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "bulkColor", "}"}], ",", "cloneColors"}], "]"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.05"}], ",", "1.05"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"900", ",", "250"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<Coordinate (kb)\>\"", ",", "\"\<Allele frequency\>\""}], 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ticks", "[", 
            RowBox[{"0", ",", "1"}], "]"}], ",", "None"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"GridLines", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "range"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"50", ",", "15"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", "15"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Evaluate", "[", "opts", "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"plotdir", "<>", "\"\<clonal.freq.profiles.svg\>\""}], ",", 
     "plot"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.64448538961157*^9, 3.6444856761635857`*^9}, {
   3.644485756595348*^9, 3.644485866056147*^9}, 3.644592341443267*^9, {
   3.644592964563258*^9, 3.644592965456064*^9}, 3.644593573943513*^9, {
   3.644595040482214*^9, 3.644595052971675*^9}, {3.6452909114427443`*^9, 
   3.6452909222468233`*^9}, {3.662152581447649*^9, 3.6621525868563213`*^9}, {
   3.662152649371874*^9, 3.66215268136241*^9}, {3.662152931867979*^9, 
   3.6621529920251017`*^9}, {3.6621532848153152`*^9, 
   3.6621532918690987`*^9}, {3.662153460083992*^9, 3.662153460561863*^9}, {
   3.6621539781481647`*^9, 3.662153985586892*^9}, 3.662154053805131*^9, {
   3.6621541675792713`*^9, 3.662154262799491*^9}, {3.662154517801968*^9, 
   3.6621545666081333`*^9}, {3.666959276283765*^9, 3.6669593036469717`*^9}, 
   3.6669593641418123`*^9, 3.666959567250266*^9, {3.6669598575094213`*^9, 
   3.666959996722404*^9}, {3.666960142465363*^9, 3.6669601435443296`*^9}, {
   3.666960272649588*^9, 3.666960276006617*^9}, {3.6669607928148813`*^9, 
   3.6669608267037687`*^9}, {3.6669609265980997`*^9, 3.666960953746896*^9}, {
   3.666960995941379*^9, 3.666960996235291*^9}, {3.6669610695954742`*^9, 
   3.6669610882738132`*^9}, {3.666961252144306*^9, 3.6669612524150667`*^9}, {
   3.666961294559538*^9, 3.6669613009521427`*^9}, {3.6669613761669483`*^9, 
   3.666961386645203*^9}, {3.666961482790485*^9, 3.6669615420830793`*^9}, {
   3.666961603292213*^9, 3.666961616417926*^9}, {3.666961688922597*^9, 
   3.6669617481068373`*^9}, 3.666962386412253*^9, {3.666962575748674*^9, 
   3.6669625807707357`*^9}, {3.666962857016287*^9, 3.666962919117806*^9}, {
   3.666963012319664*^9, 3.66696306750235*^9}, {3.666963144581706*^9, 
   3.6669632266115923`*^9}, {3.666963285034334*^9, 3.666963304969157*^9}, 
   3.666963393775436*^9, {3.666963630075726*^9, 3.666963683093053*^9}, {
   3.666963755787426*^9, 3.666963786137699*^9}, {3.666963828251321*^9, 
   3.66696383037742*^9}, {3.666963971298037*^9, 3.666963976215036*^9}, 
   3.666967768166778*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6669614638231*^9, 3.666961480323235*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Plot of pure clones (alternative, makes sense for diploid only)\
\>", "Subsection",
 CellChangeTimes->{{3.627544895287052*^9, 3.6275449007335863`*^9}, {
  3.64241957455239*^9, 3.642419623515554*^9}, {3.644411180368328*^9, 
  3.6444111837028646`*^9}}],

Cell[BoxData[{
 RowBox[{"span", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"0.0", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"loci", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "-", 
       RowBox[{"loci", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ",", "0.0"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"range", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"loci", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"span", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"loci", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "+", 
        RowBox[{"span", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"span", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"1", "+", 
        RowBox[{"span", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clonesPlot", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"loci", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"loci", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "range"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Evaluate", "[", "opts", "]"}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"Directive", "[", 
              RowBox[{"Gray", ",", 
               RowBox[{"Opacity", "[", "1", "]"}], ",", 
               RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], "]"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"gtColor", "[", 
               RowBox[{
                RowBox[{"rects", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "i", ",", "2"}], "]"}], "]"}], "/", 
                RowBox[{"rects", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "i", ",", "3"}], "]"}], "]"}]}], "]"}], 
              ",", 
              RowBox[{"Opacity", "[", "1", "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rects", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "i", ",", "1"}], "]"}], "]"}], ",", "0"}],
                "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rects", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", 
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], ",", 
                "1"}], "}"}], ",", 
              RowBox[{"RoundingRadius", "\[Rule]", 
               RowBox[{"Offset", "[", "0", "]"}]}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"rects", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
        "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "nC"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"plotdir", "<>", "\"\<clones.\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.pdf\>\""}], ",", 
     RowBox[{"clonesPlot", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "nC"}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.62754279608745*^9, {3.627542831922681*^9, 3.627542924279345*^9}, {
   3.627543153323018*^9, 3.627543157381544*^9}, {3.627543261454585*^9, 
   3.6275432633963842`*^9}, {3.6275433135486917`*^9, 3.627543508145911*^9}, {
   3.6275442193918858`*^9, 3.627544232872239*^9}, {3.627544785552514*^9, 
   3.627544808759285*^9}, {3.627547314464102*^9, 3.627547315127996*^9}, {
   3.6275499283953238`*^9, 3.6275499983394737`*^9}, {3.6275508586936502`*^9, 
   3.627550941335597*^9}, {3.642411147197022*^9, 3.642411149331712*^9}, {
   3.6424111899669237`*^9, 3.642411214405126*^9}, {3.642411247850259*^9, 
   3.642411332464764*^9}, {3.6424114033676767`*^9, 3.642411432426764*^9}, {
   3.642419211816743*^9, 3.642419234308605*^9}, {3.642419670260459*^9, 
   3.642419680638781*^9}, 3.642419732388735*^9, {3.6424198771890697`*^9, 
   3.642419906890196*^9}, {3.642419973913651*^9, 3.642420091964924*^9}, {
   3.642420166537126*^9, 3.642420166900544*^9}, {3.642420802670479*^9, 
   3.642420813607883*^9}, {3.6424264902734823`*^9, 3.64242649123214*^9}, 
   3.662152065663772*^9, 3.662152098585306*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot of pure bulk", "Subsection",
 CellChangeTimes->{{3.6275448824930763`*^9, 3.627544890959796*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bulk", "=", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"datadir", "<>", "\"\<true.bulk.txt\>\""}], ",", 
       "\"\<Table\>\""}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bulkPlot", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"bulk", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"bulk", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}], 
        "\[Transpose]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"bulk", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"bulk", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}], 
        "\[Transpose]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"bulk", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "bulk"}], "}"}]}], "]"}]}], "}"}], 
        "\[Transpose]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", "Gray", ",", 
          RowBox[{"Opacity", "[", "1", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "None", ",", "\[IndentingNewLine]", "None"}], 
       "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"gtColor", "[", "1", "]"}], ",", 
              RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], "}"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"3", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"gtColor", "[", "0", "]"}], ",", 
              RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], "}"}]}], "}"}]}],
        "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "5"}], "]"}], ",", "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Evaluate", "[", "opts", "]"}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"plotdir", "<>", "\"\<bulk.pdf\>\""}], ",", "bulkPlot"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.627543515792672*^9, 3.62754373128796*^9}, 
   3.627543809507374*^9, {3.6275438415863113`*^9, 3.627543862843339*^9}, {
   3.627543927554953*^9, 3.627543932623666*^9}, {3.6275441019848633`*^9, 
   3.62754410676761*^9}, {3.627544144464128*^9, 3.627544166796216*^9}, {
   3.627544283125456*^9, 3.627544665023777*^9}, {3.6275447165639544`*^9, 
   3.627544723317402*^9}, {3.627544813837785*^9, 3.627544815648341*^9}, {
   3.627547321249259*^9, 3.627547321655333*^9}, {3.627547530940926*^9, 
   3.627547538082343*^9}, {3.627550019036797*^9, 3.6275500676401863`*^9}, {
   3.6275509744525414`*^9, 3.627550994464155*^9}, {3.6424111044738483`*^9, 
   3.642411105067903*^9}, {3.642411439954555*^9, 3.642411449241199*^9}, {
   3.642411502392673*^9, 3.6424115590794353`*^9}, {3.6424202260316133`*^9, 
   3.642420228500128*^9}, {3.642421305567012*^9, 3.642421305708301*^9}, {
   3.642421363561193*^9, 3.6424213666466846`*^9}, {3.642421448414516*^9, 
   3.642421565006283*^9}, {3.642426509440715*^9, 3.642426572582952*^9}, {
   3.6425806379413357`*^9, 3.64258073191903*^9}, 3.644411200894966*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Simulated mixture SNV data and cloneHD fit", "Subsection",
 CellChangeTimes->{{3.627545658427395*^9, 3.627545662686755*^9}, {
   3.627546180802339*^9, 3.6275461877325993`*^9}, {3.64241306093079*^9, 
   3.642413067161724*^9}, {3.644418473351296*^9, 3.644418494337199*^9}, 
   3.64450935525109*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"bulkInf", ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"op", "=", "0.3"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"range", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "1", ",", "0.25"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ticks", "[", 
     RowBox[{"min_", ",", "max_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"val", "=", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"Abs", "@", 
             RowBox[{"FractionalPart", "[", "i", "]"}]}], ",", "0.01"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Chop", "[", 
            RowBox[{"Min", "[", 
             RowBox[{"Abs", "[", 
              RowBox[{"range", "-", "val"}], "]"}], "]"}], "]"}], "\[Equal]", 
           "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"NumberForm", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{".005", ",", "0"}], "}"}], ",", "Black"}], "}"}], ",", 
          RowBox[{"1", "<", "2"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "\"\<\>\"", ",", 
            RowBox[{"{", 
             RowBox[{".0025", ",", "0"}], "}"}], ",", "Black"}], "}"}]}], 
         "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Floor", "[", "min", "]"}], ",", 
        RowBox[{"Ceiling", "[", "max", "]"}], ",", "0.05"}], "}"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plots", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"clonalInf", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "8", ",", 
                  RowBox[{"Length", "[", "clonalInf", "]"}]}], "}"}]}], "]"}],
               "]"}], "/", 
             SuperscriptBox["10", "3"]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "#"}], "}"}], "&"}], "/@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"clonalInf", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"5", ";;", 
                    RowBox[{"-", "1"}]}]}], "]"}], "]"}], ".", 
                 RowBox[{"levels", "[", 
                  RowBox[{"[", "s", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "8", ",", 
                  RowBox[{"Length", "[", "clonalInf", "]"}]}], "}"}]}], 
               "]"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], 
          "\[Transpose]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", 
            RowBox[{"mixtureSNV", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"900", ",", 
             RowBox[{"200", "+", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"s", "\[Equal]", "nS"}], ",", "50", ",", "15"}], 
               "]"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"s", "\[Equal]", "nS"}], ",", 
               "\"\<Coordinate (kb)\>\"", ",", "None"}], "]"}], ",", 
             "\"\<Allele frequency\>\""}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ticks", "[", 
                RowBox[{"0", ",", "1"}], "]"}], ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"s", "\[Equal]", "nS"}], ",", "Automatic", ",", 
                 "None"}], "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "range"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"50", ",", "15"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"s", "\[Equal]", "nS"}], ",", "50", ",", "15"}], 
                "]"}], ",", "15"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Evaluate", "[", "opts", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"RandomChoice", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"Tr", "[", 
                    RowBox[{"\[Alpha]", "[", 
                    RowBox[{"[", "s", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"\[Alpha]", "[", 
                    RowBox[{"[", "s", "]"}], "]"}]}], "}"}], "]"}], "\[Rule]", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", "bulkColor", "}"}], ",", "cloneColors"}], 
                  "]"}]}], "]"}], ",", 
               RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
               RowBox[{"AbsolutePointSize", "[", "5", "]"}]}], "]"}], ",", 
             RowBox[{"Point", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"mixtureSNV", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"mixtureSNV", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"2", "*", "s"}]}], "]"}], "]"}], "/", 
                 RowBox[{"mixtureSNV", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{"2", "s"}], "+", "1"}]}], "]"}], "]"}]}]}], "}"}],
               "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "mixtureSNV", "]"}]}], "}"}]}], "]"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"f", "[", "x", "]"}], "+", 
            RowBox[{"2", 
             RowBox[{"g", "[", "x", "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"Tr", "[", 
                RowBox[{"\[Alpha]", "[", 
                 RowBox[{"[", "s", "]"}], "]"}], "]"}]}], ")"}]}]}], "2"], 
          ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", 
            RowBox[{"mixtureSNV", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Darker", "[", "Black", "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "1.5", "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"s", ",", "1", ",", "nS"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"plotdir", "<>", "\"\<mixture.freq.profiles.\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.svg\>\""}], ",", 
     RowBox[{"plots", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "plots", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.62754567856496*^9, 3.627545682479903*^9}, {
   3.627545766108485*^9, 3.6275457678480377`*^9}, {3.627545844522541*^9, 
   3.627545846165392*^9}, {3.627545886673523*^9, 3.627545923824387*^9}, {
   3.6275459566075077`*^9, 3.6275459763641644`*^9}, {3.6275460240408573`*^9, 
   3.627546053057047*^9}, {3.642412697172493*^9, 3.642412718257576*^9}, {
   3.642412752872076*^9, 3.642412758960558*^9}, 3.64241301707421*^9, {
   3.642413079880877*^9, 3.642413112330427*^9}, {3.642413229638941*^9, 
   3.6424132639257717`*^9}, 3.642422315333283*^9, {3.642422348253594*^9, 
   3.642422403733823*^9}, {3.642422503461439*^9, 3.64242254076855*^9}, {
   3.642422610918688*^9, 3.642422677874878*^9}, 3.642422924507065*^9, {
   3.64242299448654*^9, 3.642423024329557*^9}, {3.642423162378685*^9, 
   3.642423167239849*^9}, 3.6424232688223143`*^9, {3.642423353926682*^9, 
   3.642423368682172*^9}, 3.642426802426174*^9, {3.643439328330338*^9, 
   3.643439344097385*^9}, {3.643439405141165*^9, 3.643439480014555*^9}, {
   3.6434395302180967`*^9, 3.643439553196871*^9}, {3.643439612916411*^9, 
   3.643439684303667*^9}, {3.644411330230029*^9, 3.64441133132847*^9}, {
   3.644411379417487*^9, 3.6444116286835814`*^9}, {3.644411787270124*^9, 
   3.644411846662197*^9}, {3.644411880951743*^9, 3.644411883309288*^9}, {
   3.6444119802442827`*^9, 3.644412083077362*^9}, {3.644412472267152*^9, 
   3.644412475357237*^9}, {3.644412515810451*^9, 3.6444126363655043`*^9}, {
   3.644412666800126*^9, 3.6444127251094637`*^9}, {3.644413483592059*^9, 
   3.644413515206915*^9}, {3.6444135486360826`*^9, 3.644413595573131*^9}, {
   3.644413626101556*^9, 3.644413642066245*^9}, {3.6444136812407093`*^9, 
   3.644413707821906*^9}, {3.644413775840446*^9, 3.644413843839624*^9}, {
   3.6444138794476557`*^9, 3.644413939958582*^9}, {3.644414347005599*^9, 
   3.644414363551526*^9}, 3.644415189219954*^9, {3.644415221709216*^9, 
   3.6444152460661097`*^9}, {3.644415282133338*^9, 3.644415297723318*^9}, {
   3.644417663563644*^9, 3.644417726229332*^9}, {3.6444177761829033`*^9, 
   3.644417843166176*^9}, {3.6444179486829042`*^9, 3.644418181273178*^9}, {
   3.64441821882071*^9, 3.6444182850240307`*^9}, {3.644418316530534*^9, 
   3.644418347385254*^9}, {3.644418412676923*^9, 3.644418499166979*^9}, {
   3.644419979995962*^9, 3.644419994650899*^9}, {3.6444200329435673`*^9, 
   3.644420058013308*^9}, 3.6444768963474216`*^9, {3.644485995690583*^9, 
   3.644486196793405*^9}, {3.644486294084033*^9, 3.64448656088595*^9}, {
   3.644486614988303*^9, 3.6444866467968683`*^9}, {3.644486685309236*^9, 
   3.6444866900118732`*^9}, {3.644486886459251*^9, 3.6444869460913877`*^9}, {
   3.644487098359617*^9, 3.6444871195274363`*^9}, {3.6445075282029*^9, 
   3.6445075551753693`*^9}, {3.6445084218852177`*^9, 3.644508437027969*^9}, {
   3.644508471861041*^9, 3.644508538819913*^9}, {3.644508650365591*^9, 
   3.6445087280526047`*^9}, 3.644508803746971*^9, 3.6445089146809587`*^9, 
   3.6445093552543364`*^9, {3.644592254842865*^9, 3.6445922805554533`*^9}, {
   3.6445925886872396`*^9, 3.644592615895817*^9}, {3.644592663998754*^9, 
   3.6445926853796*^9}, {3.644592728712143*^9, 3.644592761513714*^9}, {
   3.644592808195986*^9, 3.644592842614129*^9}, 3.644592885027707*^9, {
   3.6445929225654163`*^9, 3.64459293866292*^9}, {3.6445930070584793`*^9, 
   3.644593033931404*^9}, {3.644593190569758*^9, 3.644593191398653*^9}, {
   3.644593238215534*^9, 3.644593270471681*^9}, {3.644593642513776*^9, 
   3.6445936836254053`*^9}, {3.644594206316317*^9, 3.6445943339768267`*^9}, {
   3.644594913925103*^9, 3.644594933641261*^9}, {3.6445950741861362`*^9, 
   3.644595131666048*^9}, {3.644595633310042*^9, 3.644595642456914*^9}, {
   3.662152347862678*^9, 3.6621523536222486`*^9}, {3.6621524478231792`*^9, 
   3.662152449341115*^9}, 3.662152495783997*^9, {3.6621528260428343`*^9, 
   3.662152848705358*^9}, 3.662152895841503*^9, {3.662153020553646*^9, 
   3.6621530670253277`*^9}, {3.662153527295782*^9, 3.66215352939515*^9}, {
   3.6621536169254*^9, 3.662153620508697*^9}, {3.662154288656583*^9, 
   3.662154315334762*^9}, {3.662154401795507*^9, 3.66215442748186*^9}, 
   3.662154475407277*^9, {3.666249246882359*^9, 3.6662492781306562`*^9}, 
   3.666960012579873*^9, {3.666960192090274*^9, 3.666960226040979*^9}, {
   3.666960280360237*^9, 3.6669602854794807`*^9}, {3.66696032970988*^9, 
   3.6669603342463713`*^9}, {3.666963312834997*^9, 3.6669633327045813`*^9}, 
   3.6669633897929688`*^9, 3.666963995332225*^9, {3.666968470018256*^9, 
   3.66696855033423*^9}, {3.6669687702827473`*^9, 3.666968776650947*^9}, 
   3.666969039699438*^9, 3.666969084436652*^9, 3.666969175634102*^9}]
}, Open  ]]
},
WindowSize->{1436, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 25, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 4568, 103, 318, "Input"],
Cell[CellGroupData[{
Cell[5150, 127, 10095, 136, 35, "Subsubsection"],
Cell[15248, 265, 17386, 292, 352, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32671, 562, 123, 1, 44, "Subsection"],
Cell[32797, 565, 3264, 86, 233, "Input"],
Cell[36064, 653, 2502, 58, 165, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38603, 716, 228, 3, 44, "Subsection"],
Cell[38834, 721, 16093, 454, 930, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54964, 1180, 132, 1, 44, "Subsection"],
Cell[55099, 1183, 10003, 256, 600, "Input"],
Cell[65105, 1441, 90, 1, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[65232, 1447, 260, 5, 36, "Subsection"],
Cell[65495, 1454, 6013, 148, 420, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[71545, 1607, 107, 1, 36, "Subsection"],
Cell[71655, 1610, 4947, 120, 437, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[76639, 1735, 302, 4, 36, "Subsection"],
Cell[76944, 1741, 14474, 319, 680, "Input"]
}, Open  ]]
}
]
*)

